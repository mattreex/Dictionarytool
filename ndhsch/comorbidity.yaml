$schema: "http://json-schema.org/draft-04/schema#"

id: "comorbidity"
title: Comorbidity
type: object
nodeTerms: null
namespace: https://niaid.bionimbus.org
category: clinical
program: '*'
project: '*'
description: History of comorbidities related to the subject.
additionalProperties: false
submittable: true
validators: null

systemProperties:
  - id
  - project_id
  - state
  - created_datetime
  - updated_datetime

links:
  - name: subjects
    backref: comorbidities
    label: describes
    target_type: subject
    multiplicity: one_to_one
    required: true

required:
  - submitter_id
  - type
  - subjects

uniqueKeys:
  - [id]
  - [project_id, submitter_id]

properties:

  $ref: "_definitions.yaml#/ubiquitous_properties"

  bshbvstat:
    description: Baseline HBV serostatus (based on 1st 3 visits)
    terms:
      - $ref: "_terms.yaml#/C159691"
      - $ref: "_terms.yaml#/C25213"
      - $ref: "_terms.yaml#/C14215"
    enumTerms:
      HBV negative: null
      HBV positive:
        - $ref: "_terms.yaml#/C141405"
      missing/unknown:
        - $ref: "_terms.yaml#/C54031"

  bshcvstat:
    description: Baseline HCV serostatus (based on 1st 3 visits)
    terms:
      - $ref: "_terms.yaml#/C159691"
      - $ref: "_terms.yaml#/C25213"
      - $ref: "_terms.yaml#/C14312"
    enumTerms:
      HCV negative: null
      HCV positive:
        - $ref: "_terms.yaml#/C129452"
      missing/unknown:
        - $ref: "_terms.yaml#/C54031"

  frstcncrd:
    description: First confirmed cancer year
    terms:
      - $ref: "_terms.yaml#/C159701"
      - $ref: "_terms.yaml#/C9305"
    type: integer

  frstcncrv:
    description: First confirmed cancer visit
    terms:
      - $ref: "_terms.yaml#/C159701"
      - $ref: "_terms.yaml#/C159705"
    type: integer

  frstdmd:
    description: First visit year with diabetes
    terms:
      - $ref: "_terms.yaml#/C159708"
      - $ref: "_terms.yaml#/C2985"
    type: integer

  frstdmmd:
    description: First visit year with all necessary components to determine diabetes
    terms:
      - $ref: "_terms.yaml#/C159707"
      - $ref: "_terms.yaml#/C2985"
    type: integer

  frstdmmv:
    description: First visit with all necessary components to determine diabetes
    terms:
      - $ref: "_terms.yaml#/C159707"
      - $ref: "_terms.yaml#/C2985"
    type: integer

  frstdmv:
    description: First visit with diabetes
    terms:
      - $ref: "_terms.yaml#/C159696"
      - $ref: "_terms.yaml#/C2985"
    type: integer

  frsthtnd:
    description: First visit year with hypertension
    terms:
      - $ref: "_terms.yaml#/C159708"
      - $ref: "_terms.yaml#/C3117"
    type: integer

  frsthtnmd:
    description: First visit year with all necessary components to determine hypertension
    terms:
      - $ref: "_terms.yaml#/C159701"
      - $ref: "_terms.yaml#/C159705"
    type: integer

  frsthtnmv:
    description: First visit with all necessary components to determine hypertension
    terms:
      - $ref: "_terms.yaml#/C159707"
      - $ref: "_terms.yaml#/C3117"
    type: integer

  frsthtnv:
    description: First visit with hypertension
    terms:
      - $ref: "_terms.yaml#/C159696"
      - $ref: "_terms.yaml#/C3117"
    type: integer

  subjects:
    $ref: "_definitions.yaml#/to_one"
